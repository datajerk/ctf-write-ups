#!/usr/bin/env python3

from pwn import *

binary = context.binary = ELF('./gambler-baby1', checksec=False)

if args.REMOTE:
	p = remote('ctf.b01lers.com', 9202)
	flag = b'bctf{'
else:
	p = process(binary.path)
	flag = b'flag{'

from ctypes import *
libc = cdll.LoadLibrary('libc.so.6')

while True:
	if flag in p.recvuntil([b'letters: ',flag]):
		flag += p.recvline().strip()
		p.close()
		print(flag.decode())
		break

	word = ''
	for i in range(4):
		rand = libc.rand()
		word += chr(((rand & 0xff) + (((rand // 0x1a) & 0xff) * -0x1a) + ord('a')) & 0xff)

	p.sendline(word.encode())
